<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dar de alta una prueba</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <a href="https://blogsaverroes.juntadeandalucia.es/iestorrredelosguzmanes/" target="_blank">
            <img src="img/logo.png" alt="Logotipo Instituto" id="logo">
        </a>
        <h1>Dar de alta una prueba</h1>
        <div class="contenedorBotonInicio">
            <button class="botonInicio" onclick="goHome()">Inicio</button>
        </div>
    </header>

    <main>
        <div class="contenedorFormulario">
            <form id="formPrueba" action="http://localhost:8080/ProyectoServlet" method="POST">
                <input type="hidden" name="action" value="insertarPrueba">

                <label for="nombreFase">Nombre fase:</label>
                <select id="nombreFase" name="nombreFase" onchange="actualizarEquipos()" required>
                    <option value="">Selecciona una fase</option>
                    <option value="Primera Fase">Primera Fase</option>
                    <option value="Segunda Fase">Segunda Fase</option>
                    <option value="Semifinal">Semifinal</option>
                    <option value="Final">Final</option>
                </select>

                <label for="numEquipos">Número de equipos:</label>
                <input type="number" id="numEquipos" name="numEquipos" readonly>

                <label for="nombrePrueba">Nombre de la prueba:</label>
                <select id="nombrePrueba" name="nombrePrueba" required>
                    <option value="">--Selecciona una prueba--</option>
                </select>

                <label for="numeroJueces">Número de jueces:</label>
                <input type="number" id="numeroJueces" name="numeroJueces" min="1" required>

                <label for="mejorOrador">¿Existe mejor orador?</label>
                <select id="mejorOrador" name="mejorOrador">
                    <option value="false">No</option>
                    <option value="true">Sí</option>
                </select>

                <fieldset>
                    <legend>Salas (Selecciona una o varias):</legend>
                    <div class="marcadorSalas">
                        <input type="checkbox" id="sala1" name="salas[]" value="Biblioteca">
                        <label for="sala1">Biblioteca</label>
                        <input type="checkbox" id="sala2" name="salas[]" value="Salon de actos">
                        <label for="sala2">Salón de actos</label>
                        <input type="checkbox" id="sala3" name="salas[]" value="Salon de idiomas">
                        <label for="sala3">Salón de idiomas</label>
                    </div>
                </fieldset>

                <button type="submit">Dar de alta</button>
            </form>
            <div id="mensaje"></div>
        </div>
    </main>

    <script>
    function goHome() {
        window.location.href = "inicio.html";
    }

    const pruebasPorFase = {
        "Primera Fase": ["Mejor Introducción", "Debate inicial", "Mejor Refutación"],
        "Segunda Fase": ["Mejor Argumentación", "Contra-Argumentación"],
        "Semifinal": ["Mejor Estrategia"],
        "Final": ["Defensa Final"]
    };

    function actualizarEquipos() {
        const fase = document.getElementById("nombreFase").value;
        const inputEquipos = document.getElementById("numEquipos");
        const selectPrueba = document.getElementById("nombrePrueba");

        const equiposPorFase = {
            "Primera Fase": 16,
            "Segunda Fase": 8,
            "Semifinal": 4,
            "Final": 2
        };

        inputEquipos.value = equiposPorFase[fase] || "";

        selectPrueba.innerHTML = `<option value="">--Selecciona una prueba--</option>`;

        if (pruebasPorFase[fase]) {
            for (let prueba of pruebasPorFase[fase]) {
                selectPrueba.innerHTML += `<option value="${prueba}">${prueba}</option>`;
            }
        }
    }

    document.getElementById("formPrueba").addEventListener("submit", function(event) {
        event.preventDefault();

        const mensaje = document.getElementById("mensaje");
        mensaje.textContent = "Prueba registrada correctamente, en 5 segundos serás redirigido a la página principal.";

        setTimeout(goHome, 5000);
    });
    </script>
</body>
</html>

